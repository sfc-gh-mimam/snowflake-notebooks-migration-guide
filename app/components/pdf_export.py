[{"text": "\"\"\"PDF export functionality.\"\"\"\n\nimport streamlit as st\nfrom datetime import datetime\nimport base64\nfrom io import BytesIO\ntry:\n    from weasyprint import HTML, CSS\n    WEASYPRINT_AVAILABLE = True\nexcept ImportError:\n    WEASYPRINT_AVAILABLE = False\n\n\ndef generate_pdf_html(title: str, content: str) -> str:\n    \"\"\"Generate HTML content for PDF export.\"\"\"\n    timestamp = datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")\n\n    html = f\"\"\"\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset=\"UTF-8\">\n        <style>\n            @page {{\n                margin: 2cm;\n                @bottom-right {{\n                    content: \"Page \" counter(page) \" of \" counter(pages);\n                    font-size: 9pt;\n                    color: #666;\n                }}\n            }}\n            body {{\n                font-family: 'Helvetica', 'Arial', sans-serif;\n                line-height: 1.6;\n                color: #333;\n                font-size: 11pt;\n            }}\n            h1 {{\n                color: #29B5E8;\n                border-bottom: 3px solid #29B5E8;\n                padding-bottom: 10px;\n                margin-top: 0;\n            }}\n            h2 {{\n                color: #1a8fc9;\n                margin-top: 30px;\n                border-bottom: 1px solid #E0E0E0;\n                padding-bottom: 5px;\n            }}\n            h3 {{\n                color: #29B5E8;\n                margin-top: 20px;\n            }}\n            table {{\n                width: 100%;\n                border-collapse: collapse;\n                margin: 15px 0;\n                page-break-inside: avoid;\n            }}\n            th {{\n                background-color: #29B5E8;\n                color: white;\n                padding: 10px;\n                text-align: left;\n                font-weight: 600;\n            }}\n            td {{\n                padding: 8px;\n                border-bottom: 1px solid #E0E0E0;\n            }}\n            .disclaimer {{\n                background-color: #FFF9E6;\n                border: 1px solid #FFD700;\n                padding: 15px;\n                margin: 20px 0;\n                border-radius: 5px;\n                font-size: 9pt;\n            }}\n            .info-box {{\n                background-color: #F0F8FF;\n                border-left: 4px solid #29B5E8;\n                padding: 15px;\n                margin: 15px 0;\n            }}\n            .header {{\n                text-align: center;\n                margin-bottom: 30px;\n            }}\n            .footer {{\n                margin-top: 40px;\n                padding-top: 20px;\n                border-top: 1px solid #E0E0E0;\n                font-size: 9pt;\n                color: #666;\n                text-align: center;\n            }}\n            code {{\n                background-color: #F5F5F5;\n                padding: 2px 5px;\n                border-radius: 3px;\n                font-family: 'Courier New', monospace;\n                font-size: 10pt;\n            }}\n            pre {{\n                background-color: #F5F5F5;\n                padding: 15px;\n                border-radius: 5px;\n                border-left: 3px solid #29B5E8;\n                overflow-x: auto;\n                font-size: 9pt;\n                page-break-inside: avoid;\n            }}\n            .metric-card {{\n                background: linear-gradient(135deg, #29B5E8 0%, #1a8fc9 100%);\n                color: white;\n                padding: 20px;\n                border-radius: 8px;\n                text-align: center;\n                margin: 15px 0;\n                page-break-inside: avoid;\n            }}\n            .metric-value {{\n                font-size: 32pt;\n                font-weight: bold;\n                margin: 10px 0;\n            }}\n            .metric-label {{\n                font-size: 10pt;\n                text-transform: uppercase;\n                letter-spacing: 1px;\n            }}\n        </style>\n    </head>\n    <body>\n        <div class=\"header\">\n            <h1>{title}</h1>\n            <p><strong>Snowflake Notebooks Migration Guide</strong></p>\n            <p style=\"font-size: 9pt; color: #666;\">Generated: {timestamp}</p>\n        </div>\n        \n        {content}\n        \n        <div class=\"footer\">\n            <p>This document was generated by the Snowflake Notebooks Migration Tool.</p>\n            <p>For questions or support, contact your Snowflake account team.</p>\n        </div>\n        \n        <div class=\"disclaimer\">\n            <strong>Pricing Disclaimer:</strong> Cost estimates are based on placeholder rates \n            and may not reflect your actual Snowflake pricing. Please consult with your \n            Snowflake account team for accurate pricing specific to your contract and region.\n        </div>\n    </body>\n    </html>\n    \"\"\"\n    return html\n\n\ndef create_pdf_download_button(\n    html_content: str,\n    title: str,\n    filename: str = \"export.pdf\",\n    button_text: str = \"Download PDF\"\n):\n    \"\"\"Create a download button for PDF export.\"\"\"\n    if not WEASYPRINT_AVAILABLE:\n        st.warning(\"PDF export requires WeasyPrint. Install with: pip install weasyprint\")\n        return\n\n    full_html = generate_pdf_html(title, html_content)\n\n    try:\n        # Generate PDF\n        pdf_bytes = HTML(string=full_html).write_pdf()\n\n        # Create download button\n        b64_pdf = base64.b64encode(pdf_bytes).decode()\n        href = f'<a href=\"data:application/pdf;base64,{b64_pdf}\" download=\"{filename}\" style=\"text-decoration: none;\"><button style=\"background-color: #29B5E8; color: white; padding: 0.5rem 1rem; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;\">{button_text}</button></a>'\n        st.markdown(href, unsafe_allow_html=True)\n\n    except Exception as e:\n        st.error(f\"Error generating PDF: {str(e)}\")\n\n\ndef format_table_for_pdf(df) -> str:\n    \"\"\"Convert a pandas DataFrame to HTML table for PDF.\"\"\"\n    return df.to_html(index=False, border=0, classes=\"pdf-table\")\n\n\ndef format_sql_for_pdf(sql: str) -> str:\n    \"\"\"Format SQL code for PDF display.\"\"\"\n    return f\"<pre><code>{sql}</code></pre>\"\n", "type": "text"}]